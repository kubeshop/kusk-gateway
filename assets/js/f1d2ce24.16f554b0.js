"use strict";(self.webpackChunkkusk_gateway_docs_2=self.webpackChunkkusk_gateway_docs_2||[]).push([[3832],{3905:(e,t,n)=>{n.d(t,{Zo:()=>c,kt:()=>m});var a=n(67294);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,a,o=function(e,t){if(null==e)return{};var n,a,o={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var p=a.createContext({}),s=function(e){var t=a.useContext(p),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},c=function(e){var t=s(e.components);return a.createElement(p.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},d=a.forwardRef((function(e,t){var n=e.components,o=e.mdxType,r=e.originalType,p=e.parentName,c=l(e,["components","mdxType","originalType","parentName"]),d=s(n),m=o,k=d["".concat(p,".").concat(m)]||d[m]||u[m]||r;return n?a.createElement(k,i(i({ref:t},c),{},{components:n})):a.createElement(k,i({ref:t},c))}));function m(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var r=n.length,i=new Array(r);i[0]=d;var l={};for(var p in t)hasOwnProperty.call(t,p)&&(l[p]=t[p]);l.originalType=e,l.mdxType="string"==typeof e?e:o,i[1]=l;for(var s=2;s<r;s++)i[s]=n[s];return a.createElement.apply(null,i)}return a.createElement.apply(null,n)}d.displayName="MDXCreateElement"},41313:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>p,contentTitle:()=>i,default:()=>u,frontMatter:()=>r,metadata:()=>l,toc:()=>s});var a=n(87462),o=(n(67294),n(3905));const r={},i="4. Mock an API",l={unversionedId:"getting-started/mock-an-api",id:"getting-started/mock-an-api",title:"4. Mock an API",description:"In this section you will deploy a mocked API.",source:"@site/docs/getting-started/mock-an-api.md",sourceDirName:"getting-started",slug:"/getting-started/mock-an-api",permalink:"/getting-started/mock-an-api",draft:!1,editUrl:"https://github.com/kubeshop/kusk-gateway/docs/getting-started/mock-an-api.md",tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"3. Install Kusk Gateway",permalink:"/getting-started/install-kusk-gateway"},next:{title:"5. Connecting an Application",permalink:"/getting-started/connecting-an-application"}},p={},s=[{value:"Create an OpenAPI definition",id:"create-an-openapi-definition",level:2},{value:"Apply the OpenAPI definition to Kusk",id:"apply-the-openapi-definition-to-kusk",level:2},{value:"Test the API",id:"test-the-api",level:2}],c={toc:s};function u(e){let{components:t,...n}=e;return(0,o.kt)("wrapper",(0,a.Z)({},c,n,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"4-mock-an-api"},"4. Mock an API"),(0,o.kt)("p",null,"In this section you will deploy a mocked API."),(0,o.kt)("p",null,"A mocked API is an API that returns fake API responses. Kusk reads the OpenAPI schema and can provide those mocked results, without the need of having an implementation of the API. "),(0,o.kt)("p",null,"A mock API is helpful when, for example, a frontend team does not want to get blocked by the backend team's API implementation, so the frontend team can start working on using the API when scaffolding their work."),(0,o.kt)("h2",{id:"create-an-openapi-definition"},"Create an OpenAPI definition"),(0,o.kt)("p",null,"To configure Kusk Gateway, you will need to create an OpenAPI definition of your API. Once created, you can add the gateway configurations as OpenAPI extensions (similar to code annotations). The Kusk OpenAPI extension starts with ",(0,o.kt)("inlineCode",{parentName:"p"},"x-kusk"),"."),(0,o.kt)("p",null,"For mocking to work, you will need to have an ",(0,o.kt)("inlineCode",{parentName:"p"},"example")," field under ",(0,o.kt)("inlineCode",{parentName:"p"},"Content-Type")," section, in this case under ",(0,o.kt)("inlineCode",{parentName:"p"},"application/json"),". "),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-yaml",metastring:'title="api.yaml"',title:'"api.yaml"'},'openapi: 3.0.0\ninfo:\n  title: simple-api\n  version: 0.1.0\nx-kusk:\n  mocking:\n    enabled: true\npaths:\n  /hello:\n    get:\n      responses:\n        "200":\n          description: A simple hello world!\n          content:\n            application/json:\n              example: \n                message: Hello from a mocked response!\n              schema:\n                type: object\n                properties:\n                  message:\n                    type: string\n')),(0,o.kt)("h2",{id:"apply-the-openapi-definition-to-kusk"},"Apply the OpenAPI definition to Kusk"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-sh"},"kusk deploy -i api.yaml\n")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-sh",metastring:'title="Expected output:"',title:'"Expected','output:"':!0},"\ud83c\udf89 successfully parsed api.yaml\n\u2705 initiallizing deployment to fleet kusk-gateway-envoy-fleet\n\ud83c\udf89 api.gateway.kusk.io/simple-api created\n")),(0,o.kt)("h2",{id:"test-the-api"},"Test the API"),(0,o.kt)("p",null,"First, you'll need to get the IP address of the API by running the following command: "),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-sh"},"kusk ip\n")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-sh",metastring:'title="Expected output:"',title:'"Expected','output:"':!0},"123.45.67.89\n")),(0,o.kt)("p",null,"And now test the API using ",(0,o.kt)("inlineCode",{parentName:"p"},"curl"),": "),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-sh"},"curl 123.45.67.89/hello\n")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-sh",metastring:'title="Expected output:"',title:'"Expected','output:"':!0},'{"message":"Hello from a mocked response!"}\n')),(0,o.kt)("admonition",{type:"info"},(0,o.kt)("p",{parentName:"admonition"},"If you're running a local cluster with Minikube you might not have an IP address when running ",(0,o.kt)("inlineCode",{parentName:"p"},"kusk ip")," and you might find the following message:"),(0,o.kt)("pre",{parentName:"admonition"},(0,o.kt)("code",{parentName:"pre",className:"language-sh"},"EnvoyFleet doesn't have an External IP address assigned yet. Try port-forwarding by running:\n\n kubectl port-forward svc/kusk-gateway-envoy-fleet -n kusk-system 8080:80\n")),(0,o.kt)("p",{parentName:"admonition"},"You should run the suggested command and when using ",(0,o.kt)("inlineCode",{parentName:"p"},"curl")," you would need to run it as follows:"),(0,o.kt)("pre",{parentName:"admonition"},(0,o.kt)("code",{parentName:"pre",className:"language-sh"},"curl localhost:8080/hello\n"))))}u.isMDXComponent=!0}}]);