"use strict";(self.webpackChunkkusk_gateway_docs_2=self.webpackChunkkusk_gateway_docs_2||[]).push([[729],{3905:(e,t,r)=>{r.d(t,{Zo:()=>c,kt:()=>g});var o=r(7294);function n(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function a(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}function s(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?a(Object(r),!0).forEach((function(t){n(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):a(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function l(e,t){if(null==e)return{};var r,o,n=function(e,t){if(null==e)return{};var r,o,n={},a=Object.keys(e);for(o=0;o<a.length;o++)r=a[o],t.indexOf(r)>=0||(n[r]=e[r]);return n}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(o=0;o<a.length;o++)r=a[o],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}var i=o.createContext({}),u=function(e){var t=o.useContext(i),r=t;return e&&(r="function"==typeof e?e(t):s(s({},t),e)),r},c=function(e){var t=u(e.components);return o.createElement(i.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return o.createElement(o.Fragment,{},t)}},d=o.forwardRef((function(e,t){var r=e.components,n=e.mdxType,a=e.originalType,i=e.parentName,c=l(e,["components","mdxType","originalType","parentName"]),d=u(r),g=n,h=d["".concat(i,".").concat(g)]||d[g]||p[g]||a;return r?o.createElement(h,s(s({ref:t},c),{},{components:r})):o.createElement(h,s({ref:t},c))}));function g(e,t){var r=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var a=r.length,s=new Array(a);s[0]=d;var l={};for(var i in t)hasOwnProperty.call(t,i)&&(l[i]=t[i]);l.originalType=e,l.mdxType="string"==typeof e?e:n,s[1]=l;for(var u=2;u<a;u++)s[u]=r[u];return o.createElement.apply(null,s)}return o.createElement.apply(null,r)}d.displayName="MDXCreateElement"},8261:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>i,contentTitle:()=>s,default:()=>p,frontMatter:()=>a,metadata:()=>l,toc:()=>u});var o=r(7462),n=(r(7294),r(3905));const a={},s="Troubleshooting",l={unversionedId:"guides/troubleshooting",id:"guides/troubleshooting",title:"Troubleshooting",description:"To see what routes are set up on the gateway:",source:"@site/docs/guides/troubleshooting.md",sourceDirName:"guides",slug:"/guides/troubleshooting",permalink:"/guides/troubleshooting",draft:!1,editUrl:"https://github.com/kubeshop/kusk-gateway/docs/guides/troubleshooting.md",tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Using Cert Manager with Kusk Gateway",permalink:"/guides/cert-manager"},next:{title:"Observability",permalink:"/guides/observability"}},i={},u=[{value:"<strong>To see what routes are set up on the gateway:</strong>",id:"to-see-what-routes-are-set-up-on-the-gateway",level:2},{value:"<strong>1. Port forward to the EnvoyFleet deployment on port 19000.</strong>",id:"1-port-forward-to-the-envoyfleet-deployment-on-port-19000",level:3},{value:"<strong>2 a. Check the config dump from the browser.</strong>",id:"2-a-check-the-config-dump-from-the-browser",level:3},{value:"<strong>2 b. Alternatively, use curl and jq to query routes.</strong>",id:"2-b-alternatively-use-curl-and-jq-to-query-routes",level:3},{value:"<strong>Webhooks Timeouts During Deployment</strong>",id:"webhooks-timeouts-during-deployment",level:2}],c={toc:u};function p(e){let{components:t,...r}=e;return(0,n.kt)("wrapper",(0,o.Z)({},c,r,{components:t,mdxType:"MDXLayout"}),(0,n.kt)("h1",{id:"troubleshooting"},"Troubleshooting"),(0,n.kt)("h2",{id:"to-see-what-routes-are-set-up-on-the-gateway"},(0,n.kt)("strong",{parentName:"h2"},"To see what routes are set up on the gateway:")),(0,n.kt)("h3",{id:"1-port-forward-to-the-envoyfleet-deployment-on-port-19000"},(0,n.kt)("strong",{parentName:"h3"},"1. Port forward to the EnvoyFleet deployment on port 19000.")),(0,n.kt)("p",null,"The admin console is configured to listen on port ",(0,n.kt)("inlineCode",{parentName:"p"},"19000"),", so you will need to port-forward to it:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre"},"$ kubectl port-forward -n kusk-system deployments/kusk-gateway-envoy-fleet 19000:1900\n")),(0,n.kt)("h3",{id:"2-a-check-the-config-dump-from-the-browser"},(0,n.kt)("strong",{parentName:"h3"},"2 a. Check the config dump from the browser.")),(0,n.kt)("p",null,"Open ",(0,n.kt)("inlineCode",{parentName:"p"},"http://localhost:19000")," in your browser."),(0,n.kt)("h3",{id:"2-b-alternatively-use-curl-and-jq-to-query-routes"},(0,n.kt)("strong",{parentName:"h3"},"2 b. Alternatively, use curl and jq to query routes.")),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre"},'curl http://localhost:19000/config_dump | jq \'.configs[] | select(.["@type"] == "type.googleapis.com/envoy.admin.v3.RoutesConfigDump") | .dynamic_route_configs[].route_config.virtual_hosts[].routes[]\'\n')),(0,n.kt)("p",null,"If the command hangs at all, cancel it and run it again."),(0,n.kt)("h2",{id:"webhooks-timeouts-during-deployment"},(0,n.kt)("strong",{parentName:"h2"},"Webhooks Timeouts During Deployment")),(0,n.kt)("p",null,"You may encounter an error during the resources' deployment with kubectl like:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-shell"},'Error from server (InternalError): error when creating "examples/todomvc/kusk-backend-api.yaml": Internal error occurred: failed calling webhook "mapi.kb.io": failed to call webhook: Post "https://kusk-gateway-webhooks-service.kusk-system.svc:443/mutate-gateway-kusk-io-v1alpha1-api?timeout=10s": context deadline exceeded\n')),(0,n.kt)("p",null,"This means that K8s masters control plane can't call the webhooks service residing on Kusk Gateway Manager on TCP port 9443. This problem is not specific to Kusk Gateway Manager itself and is related to the configuration of your cluster and the firewall rules."),(0,n.kt)("p",null,"To resolve this, in your firewall settings, add port 9443 to the rule containing the list of ports allowed to be accessed by K8s masters control plane."))}p.isMDXComponent=!0}}]);