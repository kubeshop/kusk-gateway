
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="OpenAPI for Kubernetes done right">
      
      
        <meta name="author" content="Kubeshop Kusk team">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.3.1, mkdocs-material-8.3.9">
    
    
      
        <title>Static Route - Kusk Gateway</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.1d29e8d0.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.cbb835fc.min.css">
        
      
      
    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../stylesheets/base.css">
    
    <script>__md_scope=new URL("../..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  


  <script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-204665550-4","auto"),ga("set","anonymizeIp",!0),ga("send","pageview"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){var e;this.value&&(e=document.location.pathname,ga("send","pageview",e+"?q="+this.value))}),"undefined"!=typeof location$&&location$.subscribe(function(e){ga("send","pageview",e.pathname)})})</script>
  <script async src="https://www.google-analytics.com/analytics.js"></script>


    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="none" data-md-color-accent="none">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#static-route" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Kusk Gateway" class="md-header__button md-logo" aria-label="Kusk Gateway" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Kusk Gateway
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Static Route
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/kubeshop/kusk-gateway" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    kubeshop/kusk-gateway
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Kusk Gateway" class="md-nav__button md-logo" aria-label="Kusk Gateway" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    Kusk Gateway
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/kubeshop/kusk-gateway" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    kubeshop/kusk-gateway
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        Welcome
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" >
      
      
      
      
        <label class="md-nav__link" for="__nav_2">
          Getting Started
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Getting Started" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Getting Started
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../getting-started/installation/" class="md-nav__link">
        Installing Kusk Gateway
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../getting-started/deploy-an-api/" class="md-nav__link">
        Deploy an OpenAPI definition
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../getting-started/connect-a-service-to-the-api/" class="md-nav__link">
        Connect a Service to the API
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3">
          Guides
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Guides" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Guides
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../guides/working-with-extension/" class="md-nav__link">
        OpenAPI Extension
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../guides/mocking/" class="md-nav__link">
        Mocking
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../guides/validation/" class="md-nav__link">
        Validation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../guides/cors/" class="md-nav__link">
        CORS
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../guides/routing/" class="md-nav__link">
        Routing & Disabling
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../guides/timeouts/" class="md-nav__link">
        Timeouts
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../guides/basic-auth/" class="md-nav__link">
        Basic Auth
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../guides/rate-limit/" class="md-nav__link">
        Rate Limiting
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../guides/cache/" class="md-nav__link">
        Caching
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../guides/cert-manager/" class="md-nav__link">
        Using Cert Manager
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../guides/observability/" class="md-nav__link">
        Observability
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../guides/troubleshooting/" class="md-nav__link">
        Troubleshooting
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4">
          Kusk CLI
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Kusk CLI" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Kusk CLI
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../cli/overview/" class="md-nav__link">
        Installation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../cli/install-cmd/" class="md-nav__link">
        Install Kusk Gateway
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../cli/generate-cmd/" class="md-nav__link">
        Generating API CRDs
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../cli/mock-cmd/" class="md-nav__link">
        Mocking your API
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../cli/dashboard-cmd/" class="md-nav__link">
        Accessing Kusk Gateway's Dashboard
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5" type="checkbox" id="__nav_5" >
      
      
      
      
        <label class="md-nav__link" for="__nav_5">
          Kusk Dashboard
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Kusk Dashboard" data-md-level="1">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          Kusk Dashboard
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../dashboard/overview/" class="md-nav__link">
        Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../dashboard/inspecting-apis/" class="md-nav__link">
        Inspecting APIs
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../dashboard/deploying-apis/" class="md-nav__link">
        Deploying APIs
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6" type="checkbox" id="__nav_6" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_6">
          Kusk Resources
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Kusk Resources" data-md-level="1">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          Kusk Resources
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../overview/" class="md-nav__link">
        Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../api/" class="md-nav__link">
        API
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../envoyfleet/" class="md-nav__link">
        Envoy Fleet
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Static Route
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Static Route
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#limitations" class="md-nav__link">
    Limitations
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configuration-structure-description" class="md-nav__link">
    Configuration Structure Description
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#envoy-fleet" class="md-nav__link">
    Envoy Fleet
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#request-matching" class="md-nav__link">
    Request Matching
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#final-action-on-the-matched-request" class="md-nav__link">
    Final Action on the Matched Request
  </a>
  
    <nav class="md-nav" aria-label="Final Action on the Matched Request">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#redirect" class="md-nav__link">
    Redirect
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#route" class="md-nav__link">
    Route
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#example" class="md-nav__link">
    Example
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7" type="checkbox" id="__nav_7" >
      
      
      
      
        <label class="md-nav__link" for="__nav_7">
          Reference
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Reference" data-md-level="1">
        <label class="md-nav__title" for="__nav_7">
          <span class="md-nav__icon md-icon"></span>
          Reference
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/extension/" class="md-nav__link">
        OpenAPI Extension
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/architecture/" class="md-nav__link">
        Architecture
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/openapi/" class="md-nav__link">
        Dashboard API
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_8" type="checkbox" id="__nav_8" >
      
      
      
      
        <label class="md-nav__link" for="__nav_8">
          Contributing
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Contributing" data-md-level="1">
        <label class="md-nav__title" for="__nav_8">
          <span class="md-nav__icon md-icon"></span>
          Contributing
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../contributing/development/" class="md-nav__link">
        Development
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../contributing/roadmap/" class="md-nav__link">
        Roadmap
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../privacy/" class="md-nav__link">
        Privacy Policy
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#limitations" class="md-nav__link">
    Limitations
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configuration-structure-description" class="md-nav__link">
    Configuration Structure Description
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#envoy-fleet" class="md-nav__link">
    Envoy Fleet
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#request-matching" class="md-nav__link">
    Request Matching
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#final-action-on-the-matched-request" class="md-nav__link">
    Final Action on the Matched Request
  </a>
  
    <nav class="md-nav" aria-label="Final Action on the Matched Request">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#redirect" class="md-nav__link">
    Redirect
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#route" class="md-nav__link">
    Route
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#example" class="md-nav__link">
    Example
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
  <a href="https://github.com/kubeshop/kusk-gateway/blob/main/docs/customresources/staticroute.md" title="Edit this page" class="md-content__button md-icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25Z"/></svg>
  </a>



<h1 id="static-route">Static Route</h1>
<p>This resource defines manually created routing rules. It is useful to set up the routing to a non-API application, e.g. static pages or images or to route to legacy, possibly external to the cluster, APIs.</p>
<p>The Static Route resource is designed to overcome the shortcomings of OpenAPI based routing, one of which is the inability to configure "catch all prefixes" like <strong>/</strong>.
Its structure is still similar to OpenAPI and, thus, familiar to users.</p>
<p>The resource can be deployed to the API resource or completely separately. Routing information from both resources will be merged with the priority given to the <strong>API</strong> resources.</p>
<p>Once the resource manifest is deployed, Kusk Gateway Manager will use it to configure routing for Envoy Fleet.
Multiple resources can exist in different namespaces, all of them will be evaluated and the configuration merged on any action with the separate resource.
Trying to apply a resource that has conflicting routes with the existing resources (i.e. same HTTP method and path) will be rejected with the error.</p>
<h2 id="limitations"><strong>Limitations</strong></h2>
<p>Currently, the resource <strong>status</strong> field is not updated by the manager when the reconciliation of the configuration finishes.</p>
<h2 id="configuration-structure-description"><strong>Configuration Structure Description</strong></h2>
<p>The main elements of the configuration are in the <strong>spec</strong> field.</p>
<p>The elements specify how the incoming request is matched and what action to take.</p>
<p>Below is the YAML structure of the configuration. Please read further for a full explanation.</p>
<div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">gateway.kusk.io/v1alpha1</span><span class="w"></span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">StaticRoute</span><span class="w"></span>
<span class="nt">metadata</span><span class="p">:</span><span class="w"></span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">staticroute-sample</span><span class="w"></span>
<span class="nt">spec</span><span class="p">:</span><span class="w"></span>
<span class="w">  </span><span class="c1"># Envoy Fleet (its name and namespace) to deploy the configuration to, here - deployed EnvoyFleet with the name &quot;default&quot; in the namespace &quot;default&quot;.</span><span class="w"></span>
<span class="w">  </span><span class="c1"># Optional, if not specified - single (default) fleet autodetection will be performed in the cluster.</span><span class="w"></span>
<span class="w">  </span><span class="nt">fleet</span><span class="p">:</span><span class="w"></span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">default</span><span class="w"></span>
<span class="w">    </span><span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">default</span><span class="w"></span>
<span class="w">  </span><span class="nt">hosts</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">&lt;string&gt;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">&lt;string&gt;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">...</span><span class="p p-Indicator">]</span><span class="w"></span>
<span class="w">  </span><span class="nt">paths</span><span class="p">:</span><span class="w"></span>
<span class="w">    </span><span class="c1"># Consists of path matchers with HTTP methods (lowercase), which in turn either:</span><span class="w"></span>
<span class="w">    </span><span class="c1"># 1. &quot;route&quot; (proxying) to the upstream host or</span><span class="w"></span>
<span class="w">    </span><span class="c1"># 2. &quot;redirect&quot; to other endpoint</span><span class="w"></span>
<span class="w">    </span><span class="nt">&lt;path_match&gt;</span><span class="p">:</span><span class="w"></span>
<span class="w">      </span><span class="nt">&lt;http_method&gt;</span><span class="p">:</span><span class="w"></span>
<span class="w">        </span><span class="c1"># &quot;route&quot; defines proxying parameters. Mutually exclusive with &quot;redirect&quot;.</span><span class="w"></span>
<span class="w">        </span><span class="nt">route</span><span class="p">:</span><span class="w"></span>
<span class="w">          </span><span class="c1"># upstream is the container for the upstream host specification.</span><span class="w"></span>
<span class="w">          </span><span class="nt">upstream</span><span class="p">:</span><span class="w"></span>
<span class="w">            </span><span class="c1"># host defines the hostname to proxy to. Mutually exclusive with service.</span><span class="w"></span>
<span class="w">            </span><span class="nt">host</span><span class="p">:</span><span class="w"></span>
<span class="w">              </span><span class="c1"># DNS name to proxy to</span><span class="w"></span>
<span class="w">              </span><span class="nt">hostname</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">&lt;string&gt;</span><span class="w"></span>
<span class="w">              </span><span class="c1"># Port to proxy to</span><span class="w"></span>
<span class="w">              </span><span class="nt">port</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">&lt;int&gt;</span><span class="w"></span>
<span class="w">            </span><span class="c1"># service is the convenient way to configure proxying to Kubernetes services. Mutually exclusive with the &quot;host&quot;.</span><span class="w"></span>
<span class="w">            </span><span class="nt">service</span><span class="p">:</span><span class="w"></span>
<span class="w">              </span><span class="c1"># service name</span><span class="w"></span>
<span class="w">              </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">&lt;string&gt;</span><span class="w"></span>
<span class="w">              </span><span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">&lt;string&gt;</span><span class="w"></span>
<span class="w">              </span><span class="nt">port</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">8080</span><span class="w"></span>
<span class="w">            </span><span class="c1"># rewrites path with the regex and substitution patterns. </span><span class="w"></span>
<span class="w">            </span><span class="nt">rewrite</span><span class="p">:</span><span class="w"></span>
<span class="w">              </span><span class="nt">pattern</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">&lt;string&gt;</span><span class="w"> </span><span class="c1"># path regex pattern</span><span class="w"></span>
<span class="w">              </span><span class="nt">substitution</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">&lt;string&gt;</span><span class="w"> </span><span class="c1"># path substitution pattern.</span><span class="w"></span>
<span class="w">          </span><span class="c1"># Optional</span><span class="w"></span>
<span class="w">          </span><span class="nt">qos</span><span class="p">:</span><span class="w"></span>
<span class="w">            </span><span class="c1"># the timeout for the upstream connection, seconds. 0 means forever, if unspecified - 15 seconds.</span><span class="w"></span>
<span class="w">            </span><span class="nt">request_timeout</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">&lt;int&gt;</span><span class="w"></span>
<span class="w">            </span><span class="c1"># the timeout for the idle upstream of downstream connection, seconds. 0 means forever, unspecified default 1h.</span><span class="w"></span>
<span class="w">            </span><span class="nt">idle_timeout</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">&lt;int&gt;</span><span class="w"></span>
<span class="w">            </span><span class="c1"># retries define how many retries to upstream with failed (50x code) requests, number. Default 1.</span><span class="w"></span>
<span class="w">            </span><span class="nt">retries</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">&lt;int&gt;</span><span class="w"></span>
<span class="w">          </span><span class="c1"># Optional</span><span class="w"></span>
<span class="w">          </span><span class="nt">cors</span><span class="p">:</span><span class="w"></span>
<span class="w">            </span><span class="c1"># allowed origins returned in Access-Control-Allow-Origin header</span><span class="w"></span>
<span class="w">            </span><span class="c1"># the list of domain names</span><span class="w"></span>
<span class="w">            </span><span class="c1"># Note - regex other than the wildcard (&quot;*&quot;) are not supported right now.</span><span class="w"></span>
<span class="w">            </span><span class="nt">origins</span><span class="p">:</span><span class="w"></span>
<span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;*&quot;</span><span class="w"></span>
<span class="w">            </span><span class="c1"># allowed methods to call this endpoint returned in Access-Control-Allow-Methods header</span><span class="w"></span>
<span class="w">            </span><span class="c1"># the list of methods</span><span class="w"></span>
<span class="w">            </span><span class="nt">methods</span><span class="p">:</span><span class="w"></span>
<span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">POST</span><span class="w"></span>
<span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">GET</span><span class="w"></span>
<span class="w">            </span><span class="c1"># allowed headers returned in Access-Control-Allow-Headers header</span><span class="w"></span>
<span class="w">            </span><span class="c1"># the list of headers</span><span class="w"></span>
<span class="w">            </span><span class="nt">headers</span><span class="p">:</span><span class="w"></span>
<span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Content-Type</span><span class="w"></span>
<span class="w">            </span><span class="c1"># allow browser to send credentials, returned with Access-Control-Allow-Credentials header</span><span class="w"></span>
<span class="w">            </span><span class="nt">credentials</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">&lt;true|false&gt;</span><span class="w"></span>
<span class="w">            </span><span class="c1"># allowed headers that browser can access returned with  Access-Control-Expose-Headers header</span><span class="w"></span>
<span class="w">            </span><span class="c1"># the list of headers</span><span class="w"></span>
<span class="w">            </span><span class="nt">expose_headers</span><span class="p">:</span><span class="w"></span>
<span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">X-Custom-Header1</span><span class="w"></span>
<span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">X-Custom-Header2</span><span class="w"></span>
<span class="w">            </span><span class="c1"># how long to cache this CORS information for the browser, returned with Access-Control-Max-Age.</span><span class="w"></span>
<span class="w">            </span><span class="nt">max_age</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">&lt;int&gt;</span><span class="w"></span>
<span class="w">          </span><span class="c1"># Enable establishing Websockets connections</span><span class="w"></span>
<span class="w">          </span><span class="nt">websocket</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">&lt;true|false&gt;</span><span class="w"></span>
<span class="w">        </span><span class="c1"># &quot;redirect&quot; creates HTTP redirect to other endpoint. Mutually exclusive with &quot;route&quot;.</span><span class="w"></span>
<span class="w">        </span><span class="nt">redirect</span><span class="p">:</span><span class="w"></span>
<span class="w">          </span><span class="c1"># redirect to http or https</span><span class="w"></span>
<span class="w">          </span><span class="nt">scheme_redirect</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">&lt;http|https&gt;</span><span class="w"></span>
<span class="w">          </span><span class="c1"># redirect to this hostname</span><span class="w"></span>
<span class="w">          </span><span class="nt">host_redirect</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">&lt;string&gt;</span><span class="w"></span>
<span class="w">          </span><span class="c1"># redirects to different port</span><span class="w"></span>
<span class="w">          </span><span class="nt">port_redirect</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">&lt;int&gt;</span><span class="w"></span>
<span class="w">          </span><span class="c1"># redirect to different URL path. Mutually exclusive with rewrite_regex.</span><span class="w"></span>
<span class="w">          </span><span class="nt">path_redirect</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;&lt;string&gt;&quot;</span><span class="w"></span>
<span class="w">          </span><span class="c1"># redirect using the rewrite rule. Mutually exclusive with path_redirect.</span><span class="w"></span>
<span class="w">          </span><span class="nt">rewrite_regex</span><span class="p">:</span><span class="w"></span>
<span class="w">            </span><span class="c1"># regex</span><span class="w"></span>
<span class="w">            </span><span class="nt">pattern</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">&lt;string&gt;</span><span class="w"></span>
<span class="w">            </span><span class="c1"># regex parameters substitution pattern</span><span class="w"></span>
<span class="w">            </span><span class="nt">substitution</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">&lt;string&gt;</span><span class="w"></span>
<span class="w">          </span><span class="c1"># response code, by default - Permanent Redirect HTTP 308</span><span class="w"></span>
<span class="w">          </span><span class="c1"># available HTTP codes: 301, 302, 303, 307, 308</span><span class="w"></span>
<span class="w">          </span><span class="nt">response_code</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">&lt;int&gt;</span><span class="w"></span>
<span class="w">      </span><span class="nt">&lt;http_method&gt;</span><span class="p">:</span><span class="w"></span>
<span class="w">        </span><span class="l l-Scalar l-Scalar-Plain">-- skipped --</span><span class="w"></span>
</code></pre></div>
<h2 id="envoy-fleet"><strong>Envoy Fleet</strong></h2>
<p>The spec.<strong>fleet</strong> optional field specifies to which Envoy Fleet (Envoy Proxy instances with the exposing K8s Service) this configuration applies.
fleet.<strong>name</strong> and fleet.<strong>namespace</strong> reference the deployed Envoy Fleet Custom Resource name and namespace.</p>
<p>You can deploy a Static Route configuration in any namespace with any name and it will be applied to the specific Envoy Fleet.
If this option is missing, the autodetection will be performed to find the single fleet deployed in the Kubernetes cluster Fleet, which is then considered as the default Fleet.
The deployed Static Route custom resource will be changed to map to that fleet accordingly.
If there are multiple fleets deployed, spec.<strong>fleet</strong> is required to specify which in the manifest.</p>
<h2 id="request-matching"><strong>Request Matching</strong></h2>
<p>We match the incoming request by HOST header, path and HTTP method.</p>
<p>The following fields specify matching:</p>
<p><strong>hosts</strong> - Defines the list of HOST headers to which the current configuration applies. This will create the Envoy's VirtualHost with the same name and domain matching. Wildcards are possible, e.g. "*" means "any host".
Prefix and suffix wildcards are supported, but not both (i.e. <code>example.*, *example.com</code>, but not <code>*example*</code>).</p>
<p><strong>paths</strong> - The container of URL paths and HTTP methods collection to match and handle the request during the routing decision.
<em>paths</em>.<strong>path_match</strong> is the URL path string and starts with / (e.g. <em>/api</em>, <em>/robots.txt</em>). The suffix hints how to match the request:</p>
<ul>
<li>Paths ending with <code>/</code> will match everything that has that path as a prefix. E.g. <code>/api/</code> matches <code>/api/v1/id</code>, just <code>/</code> is a catch all.</li>
<li>Paths without <code>/</code> will match that path exactly. For example, <code>/resource</code> matches exactly this resource with any possible URL query.  <strong>Alpha limitations:</strong> Regexes are currently not supported.</li>
</ul>
<p><em>paths</em>.<em>path_match</em>.<strong>http_method</strong> - Adds an additional request matcher which is the lowercase HTTP method (get, post, ...). Calls to the paths with a method not set here will return "404 Not Found".</p>
<h2 id="final-action-on-the-matched-request"><strong>Final Action on the Matched Request</strong></h2>
<p>Once the request is matched, we can decide what to do with it.</p>
<p><em>paths</em>.<em>path_match</em>.http_method_match.<strong>route|redirect</strong> specifies the routing decision. The request can be either proxied to the upstream host (backend) or returned to the user as a redirect. Either <a href="#redirect"><strong>redirect</strong></a> or <a href="#route"><strong>route</strong></a> must be specified, but not both.</p>
<p><strong>Alpha Limitations:</strong> Currently additional request handling (e.g. direct request response like returning 404 Not Found) is not implemented.</p>
<h3 id="redirect"><strong>Redirect</strong></h3>
<p><strong>redirect</strong> provides HTTP redirect options with the following fields. All of them are optional but, once specified, enable a part of redirection behaviour.</p>
<p><strong>redirect</strong> structure:</p>
<div class="highlight"><pre><span></span><code><span class="nt">redirect</span><span class="p">:</span><span class="w"></span>
<span class="w">  </span><span class="nt">scheme_redirect</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">&lt;http|https&gt;</span><span class="w"> </span><span class="c1"># redirect to http or https.</span><span class="w"></span>
<span class="w">  </span><span class="nt">host_redirect</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">&lt;string&gt;</span><span class="w"> </span><span class="c1"># redirect to this hostname.</span><span class="w"></span>
<span class="w">  </span><span class="nt">port_redirect</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">&lt;string&gt;</span><span class="w"> </span><span class="c1"># redirect to this port.</span><span class="w"></span>
<span class="w">  </span><span class="nt">path_redirect</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">&lt;string&gt;</span><span class="w"> </span><span class="c1"># redirect to this path, old path is removed. Mutually exclusive with rewrite_regex.</span><span class="w"></span>
<span class="w">  </span><span class="nt">rewrite_regex</span><span class="p">:</span><span class="w"> </span><span class="c1"># redirect to this rewritten with regex path. Mutually exclusive with path_redirect.</span><span class="w"></span>
<span class="w">   </span><span class="nt">pattern</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">&lt;string&gt;</span><span class="w"> </span><span class="c1"># path regex pattern</span><span class="w"></span>
<span class="w">   </span><span class="nt">substitution</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">&lt;string&gt;</span><span class="w"> </span><span class="c1"># path substitution pattern.</span><span class="w"></span>
<span class="w">  </span><span class="nt">response_code</span><span class="p">:</span><span class="w"> </span><span class="c1"># redirect HTTP response code to return to the user. Available HTTP codes: 301, 302, 303, 307, 308</span><span class="w"></span>
<span class="w">  </span><span class="nt">strip_query</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">&lt;bool&gt;</span><span class="w"> </span><span class="c1"># strip path query during redirect, default false.</span><span class="w"></span>
</code></pre></div>
<p><strong>rewrite_regex</strong> pattern matching and substitution provides a powerful mechanism to rewrite redirect path based on incoming requests.
From Envoy's documentation:</p>
<blockquote>
<p>Indicates that during redirect, portions of the path that match the pattern should be rewritten, even allowing the substitution of capture groups from the pattern into the new path as specified by the rewrite substitution string. This is useful to allow application paths to be rewritten in a way that is aware of segments with variable content like identifiers.</p>
<p>Examples using Google’s RE2 engine:</p>
<p>The path pattern ^/service/([^/]+)(/.*)$ paired with a substitution string of \2/instance/\1 would transform /service/foo/v1/api into /v1/api/instance/foo.</p>
<p>The pattern one paired with a substitution string of two would transform /xxx/one/yyy/one/zzz into /xxx/two/yyy/two/zzz.</p>
<p>The pattern ^(.<em>?)one(.</em>)$ paired with a substitution string of \1two\2 would replace only the first occurrence of one, transforming path /xxx/one/yyy/one/zzz into /xxx/two/yyy/one/zzz.</p>
<p>The pattern (?i)/xxx/ paired with a substitution string of /yyy/ would do a case-insensitive match and transform path /aaa/XxX/bbb to /aaa/yyy/bbb.</p>
</blockquote>
<h3 id="route"><strong>Route</strong></h3>
<p><strong>route</strong> specifies how the request will be proxied to the upstream with the following fields:</p>
<p><strong>route</strong> structure:</p>
<div class="highlight"><pre><span></span><code><span class="nt">route</span><span class="p">:</span><span class="w"></span>
<span class="w">  </span><span class="c1"># upstream is the container for the upstream host specification. Either upstream.host or upstream.service must be specified.</span><span class="w"></span>
<span class="w">  </span><span class="nt">upstream</span><span class="p">:</span><span class="w"></span>
<span class="w">    </span><span class="c1"># host defines the hostname to proxy to. Mutually exclusive with service.</span><span class="w"></span>
<span class="w">    </span><span class="nt">host</span><span class="p">:</span><span class="w"></span>
<span class="w">      </span><span class="c1"># DNS hostname to proxy to</span><span class="w"></span>
<span class="w">      </span><span class="nt">hostname</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">&lt;string&gt;</span><span class="w"></span>
<span class="w">      </span><span class="c1"># host port</span><span class="w"></span>
<span class="w">      </span><span class="nt">port</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">&lt;int&gt;</span><span class="w"></span>
<span class="w">    </span><span class="c1"># service is the convenient way to configure proxying to Kubernetes services. Mutually exclusive with the &quot;host&quot;.</span><span class="w"></span>
<span class="w">    </span><span class="nt">service</span><span class="p">:</span><span class="w"></span>
<span class="w">      </span><span class="c1"># K8s service name to proxy to</span><span class="w"></span>
<span class="w">      </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">&lt;string&gt;</span><span class="w"></span>
<span class="w">      </span><span class="c1"># service namespace</span><span class="w"></span>
<span class="w">      </span><span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">&lt;string&gt;</span><span class="w"></span>
<span class="w">      </span><span class="c1"># service port</span><span class="w"></span>
<span class="w">      </span><span class="nt">port</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">&lt;int&gt;</span><span class="w"></span>
<span class="w">    </span><span class="c1"># rewrites path with the regex and substitution patterns. </span><span class="w"></span>
<span class="w">    </span><span class="nt">rewrite</span><span class="p">:</span><span class="w"></span>
<span class="w">      </span><span class="nt">pattern</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">&lt;string&gt;</span><span class="w"> </span><span class="c1"># path regex pattern</span><span class="w"></span>
<span class="w">      </span><span class="nt">substitution</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">&lt;string&gt;</span><span class="w"> </span><span class="c1"># path substitution pattern.</span><span class="w"></span>
<span class="w">  </span><span class="c1"># Quality of Service for the request</span><span class="w"></span>
<span class="w">  </span><span class="c1"># Optional</span><span class="w"></span>
<span class="w">  </span><span class="nt">qos</span><span class="p">:</span><span class="w"></span>
<span class="w">    </span><span class="c1"># the timeout for the upstream connection, seconds. 0 means forever, if unspecified - 15 seconds.</span><span class="w"></span>
<span class="w">    </span><span class="nt">request_timeout</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">&lt;int&gt;</span><span class="w"></span>
<span class="w">    </span><span class="c1"># the timeout for the idle upstream of downstream connection, seconds. 0 means forever, unspecified default 1h.</span><span class="w"></span>
<span class="w">    </span><span class="nt">idle_timeout</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">&lt;int&gt;</span><span class="w"></span>
<span class="w">    </span><span class="c1"># retries define how many retries to upstream with failed (50x code) requests, number. Default 1.</span><span class="w"></span>
<span class="w">    </span><span class="nt">retries</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">&lt;int&gt;</span><span class="w"></span>
<span class="w">  </span><span class="c1"># Optional</span><span class="w"></span>
<span class="w">  </span><span class="nt">cors</span><span class="p">:</span><span class="w"></span>
<span class="w">    </span><span class="c1"># allowed origins returned in Access-Control-Allow-Origin header</span><span class="w"></span>
<span class="w">    </span><span class="c1"># the list of domain names</span><span class="w"></span>
<span class="w">    </span><span class="c1"># Note - regex other than the wildcard (&quot;*&quot;) are not supported right now.</span><span class="w"></span>
<span class="w">    </span><span class="c1"># WARNING - this is just the example, write your own CORS settings.</span><span class="w"></span>
<span class="w">    </span><span class="nt">origins</span><span class="p">:</span><span class="w"></span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;*&quot;</span><span class="w"></span>
<span class="w">    </span><span class="c1"># allowed methods to call this endpoint returned in Access-Control-Allow-Methods header</span><span class="w"></span>
<span class="w">    </span><span class="c1"># the list of methods</span><span class="w"></span>
<span class="w">    </span><span class="nt">methods</span><span class="p">:</span><span class="w"></span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">POST</span><span class="w"></span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">GET</span><span class="w"></span>
<span class="w">    </span><span class="c1"># allowed headers returned in Access-Control-Allow-Headers header</span><span class="w"></span>
<span class="w">    </span><span class="c1"># the list of headers</span><span class="w"></span>
<span class="w">    </span><span class="nt">headers</span><span class="p">:</span><span class="w"></span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Content-Type</span><span class="w"></span>
<span class="w">    </span><span class="c1"># allow browser to send credentials, returned with Access-Control-Allow-Credentials header</span><span class="w"></span>
<span class="w">    </span><span class="nt">credentials</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">&lt;true|false&gt;</span><span class="w"></span>
<span class="w">    </span><span class="c1"># allowed headers that browser can access returned with  Access-Control-Expose-Headers header</span><span class="w"></span>
<span class="w">    </span><span class="c1"># the list of headers</span><span class="w"></span>
<span class="w">    </span><span class="nt">expose_headers</span><span class="p">:</span><span class="w"></span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">X-Custom-Header1</span><span class="w"></span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">X-Custom-Header2</span><span class="w"></span>
<span class="w">    </span><span class="c1"># how long to cache this CORS information for the browser in seconds, returned with Access-Control-Max-Age header</span><span class="w"></span>
<span class="w">    </span><span class="nt">max_age</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">&lt;int&gt;</span><span class="w"></span>
<span class="w">  </span><span class="c1"># Enable establishing Websockets connections</span><span class="w"></span>
<span class="w">  </span><span class="nt">websocket</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">&lt;true|false&gt;</span><span class="w"></span>
</code></pre></div>
<p><em>route</em>.<strong>upstream</strong> - A required field that defines the upstream host parameters.
We proxy using DNS hostname or local cluster K8s service parameters, which are further resolved to DNS hostname. Either <em>upstream</em>.<strong>host</strong> or <em>upstream</em>.<strong>service</strong> must be specified inside.</p>
<p><em>route</em>.<strong>upstream</strong>.<strong>rewrite</strong> - An optional field that specifies what to do with the URL path when proxying to the upstream. The only value currently is <strong>rewrite</strong>. See the rewrite_regex section in redirect action above for the explanation.</p>
<p><em>route</em>.<strong>qos</strong> - An optional field that is the container for request Quality of Service parameters, i.e. timeouts, failure retry policy.</p>
<p><em>route</em>.<strong>cors</strong> - An optional field that is the container for <a href="https://en.wikipedia.org/wiki/Cross-origin_resource_sharing">Cross-Origin Resource Sharing</a> headers parameters. If this field is specified, the route will be augmented with CORS preflight OPTIONS HTTP method matching. This will allow Envoy to return the response to the OPTIONS request with the specified CORS headers to the user without proxying to upstream. It is advised to read <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/CORS">CORS</a> before trying to configure this.</p>
<p>Note: The structure for CORS specified above is an example; users should write their own set of methods and headers.</p>
<p><em>route</em>.<strong>websocket</strong> - An optional boolean field that defines whether to enable handling of "Upgrade: websocket" and related Websocket HTTP headers in the request to create a Websocket tunnel to the backend. The default is false - don't handle Websockets.</p>
<h2 id="example"><strong>Example</strong></h2>
<div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">gateway.kusk.io/v1alpha1</span><span class="w"></span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">StaticRoute</span><span class="w"></span>
<span class="nt">metadata</span><span class="p">:</span><span class="w"></span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">sample</span><span class="w"></span>
<span class="nt">spec</span><span class="p">:</span><span class="w"></span>
<span class="w">  </span><span class="c1"># should work with localhost, example.org, any host</span><span class="w"></span>
<span class="w">  </span><span class="nt">hosts</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="w"> </span><span class="s">&quot;localhost&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;*&quot;</span><span class="p p-Indicator">]</span><span class="w"></span>
<span class="w">  </span><span class="nt">paths</span><span class="p">:</span><span class="w"></span>
<span class="w">    </span><span class="c1"># Catch all prefix /</span><span class="w"></span>
<span class="w">    </span><span class="nt">/</span><span class="p">:</span><span class="w"> </span>
<span class="w">      </span><span class="c1"># HTTP method GET</span><span class="w"></span>
<span class="w">      </span><span class="nt">get</span><span class="p">:</span><span class="w"></span>
<span class="w">        </span><span class="nt">route</span><span class="p">:</span><span class="w"> </span><span class="nl">&amp;root_route</span><span class="w"> </span><span class="c1"># here we&#39;re using YAML anchors to decrease the boilerplate for all HTTP methods - the configuration is the same.</span><span class="w"></span>
<span class="w">          </span><span class="nt">upstream</span><span class="p">:</span><span class="w"></span>
<span class="w">            </span><span class="nt">host</span><span class="p">:</span><span class="w"></span>
<span class="w">              </span><span class="c1"># DNS name to proxy forward to</span><span class="w"></span>
<span class="w">              </span><span class="nt">hostname</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">front.somehostname.com</span><span class="w"></span>
<span class="w">              </span><span class="c1"># Port to proxy to</span><span class="w"></span>
<span class="w">              </span><span class="nt">port</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">80</span><span class="w"></span>
<span class="w">      </span><span class="nt">post</span><span class="p">:</span><span class="w"> </span><span class="nv">*root_route</span><span class="w"></span>
<span class="w">      </span><span class="nt">put</span><span class="p">:</span><span class="w"> </span><span class="nv">*root_route</span><span class="w"></span>
<span class="w">      </span><span class="nt">head</span><span class="p">:</span><span class="w"> </span><span class="nv">*root_route</span><span class="w"></span>
<span class="w">      </span><span class="nt">patch</span><span class="p">:</span><span class="w"> </span><span class="nv">*root_route</span><span class="w"></span>
<span class="w">    </span><span class="c1"># robots.txt is served by the new frontend. Here we use &quot;host&quot; to show that it can replace &quot;service&quot; safely.</span><span class="w"></span>
<span class="w">    </span><span class="nt">/robots.txt</span><span class="p">:</span><span class="w"> </span>
<span class="w">      </span><span class="nt">get</span><span class="p">:</span><span class="w"></span>
<span class="w">        </span><span class="nt">route</span><span class="p">:</span><span class="w"></span>
<span class="w">          </span><span class="nt">upstream</span><span class="p">:</span><span class="w"></span>
<span class="w">            </span><span class="nt">host</span><span class="p">:</span><span class="w"></span>
<span class="w">              </span><span class="nt">hostname</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">front.frontapps.svc.cluster.local.</span><span class="w"></span>
<span class="w">              </span><span class="nt">port</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">80</span><span class="w"></span>
<span class="w">    </span><span class="c1"># GET to /oldstatic resource redirects to /static</span><span class="w"></span>
<span class="w">    </span><span class="nt">/oldstatic/</span><span class="p">:</span><span class="w"> </span>
<span class="w">      </span><span class="nt">get</span><span class="p">:</span><span class="w"></span>
<span class="w">        </span><span class="nt">redirect</span><span class="p">:</span><span class="w"></span>
<span class="w">          </span><span class="c1"># redirect to different path /oldstatic/blabla -&gt; /static/blabla</span><span class="w"></span>
<span class="w">          </span><span class="nt">rewrite_regex</span><span class="p">:</span><span class="w"></span>
<span class="w">            </span><span class="nt">pattern</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;/oldstatic/(.*)&#39;</span><span class="w"></span>
<span class="w">            </span><span class="nt">substitution</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;/static/\1&#39;</span><span class="w"></span>
<span class="w">          </span><span class="nt">response_code</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">308</span><span class="w"></span>
<span class="w">    </span><span class="nt">/static/</span><span class="p">:</span><span class="w"></span>
<span class="w">      </span><span class="nt">get</span><span class="p">:</span><span class="w"></span>
<span class="w">        </span><span class="nt">route</span><span class="p">:</span><span class="w"></span>
<span class="w">          </span><span class="nt">upstream</span><span class="p">:</span><span class="w"></span>
<span class="w">            </span><span class="nt">service</span><span class="p">:</span><span class="w"></span>
<span class="w">              </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;front&quot;</span><span class="w"></span>
<span class="w">              </span><span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;frontapps&quot;</span><span class="w"></span>
<span class="w">              </span><span class="nt">port</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">80</span><span class="w"></span>
<span class="w">    </span><span class="c1"># GET to /images/ is proxied to K8s service images in images namespace</span><span class="w"></span>
<span class="w">    </span><span class="nt">/images/</span><span class="p">:</span><span class="w"> </span>
<span class="w">      </span><span class="nt">get</span><span class="p">:</span><span class="w"></span>
<span class="w">        </span><span class="nt">route</span><span class="p">:</span><span class="w"> </span>
<span class="w">          </span><span class="nt">upstream</span><span class="p">:</span><span class="w"></span>
<span class="w">            </span><span class="nt">service</span><span class="p">:</span><span class="w"></span>
<span class="w">              </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">images</span><span class="w"></span>
<span class="w">              </span><span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">images</span><span class="w"></span>
<span class="w">              </span><span class="nt">port</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">8080</span><span class="w"></span>
<span class="w">    </span><span class="c1"># old API is served on other path with the rewrite of path to upstream</span><span class="w"></span>
<span class="w">    </span><span class="nt">/api/v0/</span><span class="p">:</span><span class="w"></span>
<span class="w">      </span><span class="nt">get</span><span class="p">:</span><span class="w"></span>
<span class="w">        </span><span class="nt">route</span><span class="p">:</span><span class="w"> </span><span class="nl">&amp;old_api_route</span><span class="w"></span>
<span class="w">          </span><span class="nt">upstream</span><span class="p">:</span><span class="w"></span>
<span class="w">            </span><span class="nt">service</span><span class="p">:</span><span class="w"></span>
<span class="w">              </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">api0</span><span class="w"></span>
<span class="w">              </span><span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">legacy</span><span class="w"></span>
<span class="w">              </span><span class="nt">port</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">80</span><span class="w"></span>
<span class="w">            </span><span class="c1"># removes /api/v0 from the path when proxying to upstream</span><span class="w"></span>
<span class="w">            </span><span class="nt">rewrite</span><span class="p">:</span><span class="w"></span>
<span class="w">              </span><span class="nt">pattern</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;^/api/v0&quot;</span><span class="w"></span>
<span class="w">              </span><span class="nt">substitution</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="w"></span>
<span class="w">          </span><span class="c1"># Old API is slow and unreliable</span><span class="w"></span>
<span class="w">          </span><span class="nt">qos</span><span class="p">:</span><span class="w"></span>
<span class="w">            </span><span class="nt">request_timeout</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">30</span><span class="w"></span>
<span class="w">            </span><span class="nt">idle_timeout</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">60</span><span class="w"></span>
<span class="w">            </span><span class="nt">retries</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5</span><span class="w"></span>
<span class="w">          </span><span class="nt">cors</span><span class="p">:</span><span class="w"></span>
<span class="w">            </span><span class="nt">origins</span><span class="p">:</span><span class="w"></span>
<span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;*&quot;</span><span class="w"></span>
<span class="w">            </span><span class="nt">methods</span><span class="p">:</span><span class="w"></span>
<span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">GET</span><span class="w"></span>
<span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">POST</span><span class="w"></span>
<span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">PUT</span><span class="w"></span>
<span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">PATCH</span><span class="w"></span>
<span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">HEAD</span><span class="w"></span>
<span class="w">            </span><span class="nt">headers</span><span class="p">:</span><span class="w"></span>
<span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Content-Type</span><span class="w"></span>
<span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Content-Encoding</span><span class="w"></span>
<span class="w">            </span><span class="nt">credentials</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span><span class="w"></span>
<span class="w">            </span><span class="nt">expose_headers</span><span class="p">:</span><span class="w"></span>
<span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">X-API-VERSION</span><span class="w"></span>
<span class="w">            </span><span class="nt">max_age</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">8600</span><span class="w"></span>
<span class="w">          </span><span class="nt">websocket</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span><span class="w"></span>
<span class="w">      </span><span class="nt">post</span><span class="p">:</span><span class="w"> </span><span class="nv">*old_api_route</span><span class="w"></span>
<span class="w">      </span><span class="nt">put</span><span class="p">:</span><span class="w"> </span><span class="nv">*old_api_route</span><span class="w"></span>
<span class="w">      </span><span class="nt">patch</span><span class="p">:</span><span class="w"> </span><span class="nv">*old_api_route</span><span class="w"></span>
<span class="w">      </span><span class="nt">head</span><span class="p">:</span><span class="w"> </span><span class="nv">*old_api_route</span><span class="w"></span>
</code></pre></div>

              
            </article>
            
          </div>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    
    <nav class="md-footer__inner md-grid" aria-label="Footer" >
      
        
        <a href="../envoyfleet/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Envoy Fleet" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Envoy Fleet
            </div>
          </div>
        </a>
      
      
        
        <a href="../../reference/extension/" class="md-footer__link md-footer__link--next" aria-label="Next: OpenAPI Extension" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              OpenAPI Extension
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2022 <a href="https://kubeshop.io">Kubeshop</a>
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../..", "features": [], "search": "../../assets/javascripts/workers/search.b97dbffb.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.6c7ad80a.min.js"></script>
      
    
  </body>
</html>